local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")


local settings = {
    fogEnabled = false,
    brightEnabled = false,
    forceValues = {
        FogEnd = 1000000,
        FogStart = 0,
        FogColor = Color3.new(1, 1, 1),
        Brightness = 30,
        Ambient = Color3.new(0.8, 0.8, 0.8),
        OutdoorAmbient = Color3.new(0.8, 0.8, 0.8)
    }
}


local original = {
    FogEnd = Lighting.FogEnd,
    FogStart = Lighting.FogStart,
    FogColor = Lighting.FogColor,
    Atmosphere = {
        Density = Lighting.Atmosphere.Density,
        Offset = Lighting.Atmosphere.Offset,
        Color = Lighting.Atmosphere.Color,
        Decay = Lighting.Atmosphere.Decay,
        Glare = Lighting.Atmosphere.Glare,
        Haze = Lighting.Atmosphere.Haze
    },
    Brightness = Lighting.Brightness,
    Ambient = Lighting.Ambient,
    OutdoorAmbient = Lighting.OutdoorAmbient
}


local GlobalLight = Instance.new("PointLight")
GlobalLight.Brightness = 5
GlobalLight.Range = 1000
GlobalLight.Shadows = false
GlobalLight.Enabled = false
GlobalLight.Parent = workspace

local function ManageAtmosphere(enable)
    if enable then
   
        Lighting.Atmosphere.Density = 0
        Lighting.Atmosphere.Glare = 0
        Lighting.Atmosphere.Haze = 0
    else
  
        Lighting.Atmosphere.Density = original.Atmosphere.Density
        Lighting.Atmosphere.Offset = original.Atmosphere.Offset
        Lighting.Atmosphere.Color = original.Atmosphere.Color
        Lighting.Atmosphere.Decay = original.Atmosphere.Decay
        Lighting.Atmosphere.Glare = original.Atmosphere.Glare
        Lighting.Atmosphere.Haze = original.Atmosphere.Haze
    end
end

local function UpdateLoop()
    while task.wait(0.1) do
        -- Управление туманом
        if settings.fogEnabled then
            Lighting.FogEnd = settings.forceValues.FogEnd
            Lighting.FogStart = settings.forceValues.FogStart
            Lighting.FogColor = settings.forceValues.FogColor
            ManageAtmosphere(true)
        else
            Lighting.FogEnd = original.FogEnd
            Lighting.FogStart = original.FogStart
            Lighting.FogColor = original.FogColor
            ManageAtmosphere(false)
        end

        GlobalLight.Enabled = settings.brightEnabled
        if settings.brightEnabled then
            Lighting.Brightness = settings.forceValues.Brightness
            Lighting.Ambient = settings.forceValues.Ambient
            Lighting.OutdoorAmbient = settings.forceValues.OutdoorAmbient
        else
            Lighting.Brightness = original.Brightness
            Lighting.Ambient = original.Ambient
            Lighting.OutdoorAmbient = original.OutdoorAmbient
        end
    end
end

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end

    if input.KeyCode == Enum.KeyCode.F5 then
        settings.fogEnabled = not settings.fogEnabled
        print("Fog Effect:", settings.fogEnabled and "Enabled" or "Disabled")
    elseif input.KeyCode == Enum.KeyCode.F4 then
        settings.brightEnabled = not settings.brightEnabled
        print("Bright Effect:", settings.brightEnabled and "Enabled" or "Disabled")
    end
end)

task.spawn(function()
    Lighting:GetPropertyChangedSignal("FogEnd"):Connect(function()
        if settings.fogEnabled then
            Lighting.FogEnd = settings.forceValues.FogEnd
        end
    end)

    Lighting.Atmosphere:GetPropertyChangedSignal("Density"):Connect(function()
        if settings.fogEnabled then
            Lighting.Atmosphere.Density = 0
        end
    end)
end)

task.spawn(UpdateLoop)
print("Script Fixed! F5 now work correctly")